Sub SearchDatesAndInsertValues()
    Dim ws1 As Worksheet, ws2 As Worksheet
    Dim currentYear As Integer
    Dim searchDate As Date
    Dim i As Integer
    Dim insertRow As Long
    Dim targetValue As Variant
    
    ' シートの参照設定
    Set ws1 = ThisWorkbook.Sheets(1) ' Sheet(1)
    Set ws2 = ThisWorkbook.Sheets(2) ' Sheet(2)
    
    ' 現在の年を取得
    currentYear = Year(Date)
    
    ' 値を挿入する開始行（Sheet(1)のCells(2, 4)の位置を基準）
    insertRow = ws1.Cells(2, 4).Row
    
    ' Sheet(2)のCells(43, 3)からCells(43, 36)を検索
    For i = 3 To 36
        searchDate = ws2.Cells(43, i).Value ' 43行目のi列の値を取得
        
        ' 年が現在の年と同じかどうかを確認
        If Year(searchDate) = currentYear Then
            ' 年が一致する場合、同じ列の5行目の値を取得
            targetValue = ws2.Cells(5, i).Value
            
            ' Sheet(1)の挿入行にその値を入力
            ws1.Cells(insertRow, 4).Value = targetValue
            
            ' 次の行に値を挿入するため、挿入行を1つ下げる
            insertRow = insertRow + 1
        End If
    Next i
    
    MsgBox "該当する値の検索と挿入が完了しました。"
End Sub
Sub SearchStringsAndDisplayMismatch()

    Dim ws1 As Worksheet, ws2 As Worksheet
    Dim searchRange As Range, cell As Range
    Dim searchValue As String
    Dim foundCell As Range
    Dim msg As String
    Dim lastCol As Long
    Dim lastRow As Long

    ' シートを設定
    Set ws1 = ThisWorkbook.Sheets("Sheet1")
    Set ws2 = ThisWorkbook.Sheets("Sheet2")

    ' シート2の6行目の最終列を取得
    lastCol = ws2.Cells(6, ws2.Columns.Count).End(xlToLeft).Column

    ' シート1のD列5行目以降の範囲を設定
    lastRow = ws1.Cells(ws1.Rows.Count, "D").End(xlUp).Row
    Set searchRange = ws1.Range("D5:D" & lastRow)

    ' 一致しない文字列を格納するメッセージ用変数
    msg = ""

    ' シート2の6行目を順に検索
    For col = 3 To lastCol
        searchValue = ws2.Cells(6, col).Value

        ' シート1のD列で文字列を検索
        Set foundCell = searchRange.Find(What:=searchValue, LookIn:=xlValues, LookAt:=xlWhole)

        ' 一致しなかった場合、メッセージボックスに表示
        If foundCell Is Nothing Then
            msg = msg & searchValue & vbNewLine
        End If
    Next col

    ' 一致しなかった文字列を表示
    If msg <> "" Then
        MsgBox "一致しなかった文字列: " & vbNewLine & msg
    Else
        MsgBox "全ての文字列が一致しました。"
    End If

End Sub
